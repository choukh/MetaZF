# Coqé›†åˆæ¨¡å‹è®º(1-4): æ— ç©·å…¬ç†ç­‰ä»·äºå®‡å®™å­˜åœ¨

> Qç¾¤ï¼š893531731  
> [GitHub - choukh/MetaZF](https://github.com/choukh/MetaZF)  
> [æ€»ç›®å½•](https://zhuanlan.zhihu.com/p/524446016)

## å‰ç½®çŸ¥è¯†
- [SFç¬¬1å·](https://coq-zh.github.io/SF-zh/lf-current/toc.html)
- [Coqé›†åˆæ¨¡å‹è®º(1-2): ç´¯ç§¯å±‚çº§ä¸é›†åˆçš„ç§©](https://zhuanlan.zhihu.com/p/521339639)  
- [Coqé›†åˆæ¨¡å‹è®º(1-3): æé™å±‚ä¸æ ¼ç½—æ»•è¿ªå…‹å®‡å®™](https://zhuanlan.zhihu.com/p/527492919)  

## æ— ç©·å…¬ç†çš„è¡¨è¿°

æˆ‘ä»¬è€ƒè™‘æ— ç©·å…¬ç†çš„ä¸€ä¸ªå˜ä½“: $V_{<Ï‰}$ å­˜åœ¨, è®°ä½œ Infâ±½. å®ƒè•´å« Ï‰ å­˜åœ¨, è®°ä½œ Infâ±½ â†’ InfÊ·. åæ–¹å‘çš„è•´å«ç”±ä¼ ç»Ÿæ•™ç§‘ä¹¦ç»™å‡º: ç”± Ï‰ å¯ä»¥é€’å½’å®šä¹‰ $V_{<Ï‰}$. æ€»ä¹‹, æˆ‘ä»¬çš„ Infâ±½ ç­‰ä»·äºä¼ ç»Ÿçš„ InfÊ·.

å½¢å¼åœ°, ç”±ç±»å‹è®ºä¸°å¯Œçš„è¡¨è¾¾èƒ½åŠ›, æˆ‘ä»¬å¯ä»¥å®šä¹‰å…ƒè¯­è¨€ä¸Šçš„å‡½æ•°è¿­ä»£.
```Coq
(* å…ƒè¯­è¨€è¿­ä»£ *)
Fixpoint è¿­ä»£ {A} (f : A â†’ A) a n :=
  match n with
  | O => a
  | S m => f (è¿­ä»£ f a m)
  end.
```

é‚£ä¹ˆ $V_n$ å°±æ˜¯ä»ç©ºé›†å¼€å§‹çš„å¹‚è¿­ä»£, æ‰€æœ‰è¿™æ ·çš„ $V_n$ ç»„æˆçš„ç±»è®°ä½œ $V_{<Ï‰}$, è€Œ Infâ±½ å°±æ˜¯è¯´ $V_{<Ï‰}$ æ˜¯é›†åˆ.

```Coq
Definition Vâ‚™ := è¿­ä»£ å¹‚ âˆ….

(* V_<Ï‰ ç±» *)
Definition æœ‰ç©·å±‚ x := âˆƒ n, x = Vâ‚™ n.

(* æ— ç©·å…¬ç†å˜ä½“: V_<Ï‰ ç±»å¯é›†åŒ– *)
Definition Infâ±½ := setLike æœ‰ç©·å±‚.
```

å…¶ä¸­ setLike "è°“è¯"ä¸è¿‡æ˜¯ä»¥ä¸‹å¥å­çš„ç®€å†™.

```Coq
Notation "A =â‚š P" := (âˆ€ x, x âˆˆ A â†” x âˆˆâ‚š P) (at level 70).
Notation "'setLike' P" := (âˆƒ A, A =â‚š P) (only parsing, at level 10).
```

## å®‡å®™è•´å«æ— ç©·

**å¼•ç† 1-4-1** å®‡å®™çš„å­˜åœ¨æ€§ (è®°ä½œ Univ) è•´å« Infâ±½.  

```Coq
(* å­˜åœ¨å®‡å®™ *)
Definition Univ := âˆƒ u, å®‡å®™ u.

Lemma å®‡å®™è•´å«æ— ç©· : Univ â†’ Infâ±½.
```

è¯æ˜: ä» Univ æ‰¿è¯ºçš„å®‡å®™ u ä¸­åˆ†ç¦»å‡ºæœ‰ç©·å±‚ u', å®ƒå°±æ˜¯ Infâ±½ æ‰€éœ€çš„è§è¯æœ‰ç©·å±‚ setLike çš„é›†åˆ. =â‚šçš„å·¦åˆ°å³ç”±åˆ†ç¦»å…¬ç†ç«‹å³å¾—è¯.

```Coq
Proof.
  intros [u U]. exists (u âˆ©â‚š æœ‰ç©·å±‚).
  intros x. split; intros H.
  - now apply åˆ†ç¦» in H.
```

=â‚šçš„å³åˆ°å·¦éœ€è¯ $V_n âˆˆ u'$, å³è¯ $V_n âˆˆ u$ ä¸” $V_n$ æ˜¯æœ‰ç©·å±‚, åè€…å³å®šä¹‰. å¯¹å‰è€…, å¯¹ n å½’çº³. n = 0 æ—¶ç”±å®‡å®™å¯¹ç©ºé›†çš„å°é—­æ€§, n = S n æ—¶ç”±å½’çº³å‡è®¾å’Œå®‡å®™å¯¹å¹‚é›†çš„å°é—­æ€§å¾—è¯. âˆ

```Coq
  - destruct H as [n ->]. apply åˆ†ç¦». split. 2:now exists n.
    induction n. now apply å®‡å®™å¯¹ç©ºé›†å°é—­. now apply å®‡å®™å¯¹å¹‚é›†å°é—­.
Qed.
```

## æ— ç©·è•´å«å®‡å®™

æœ¬æ–‡çš„æœ€ç»ˆç›®æ ‡æ˜¯è¯æ˜ Univ ç­‰ä»·äº Infâ±½, ç”±ä¸Šæ–‡å¯è§å·¦åˆ°å³å¾ˆç®€å•, ä½†åæ–¹å‘æ¯”è¾ƒç¹ç, æˆ‘ä»¬åˆ†å‡ ä¸ªå°èŠ‚æ¥è®².

### $V_Ï‰$ æ˜¯æé™å±‚

ç”±å¤–å»¶å…¬ç†å¯çŸ¥ç±»çš„é›†åˆåŒ– (å¦‚æœå­˜åœ¨çš„è¯) æ˜¯å”¯ä¸€çš„, å†ç»“åˆ [(1-3)](https://zhuanlan.zhihu.com/p/527492919) çš„å”¯ä¸€é€‰æ‹©å‡½æ•° Î´ å¯è¯å…³äºç±»é›†åŒ–çš„å¤§æ¶ˆé™¤.

```Coq
Lemma é›†åŒ–å”¯ä¸€ P : uniqueness (Î» A, A =â‚š P). (* è¯æ˜ç•¥ *)

Lemma é›†åŒ–å¤§æ¶ˆé™¤ P : (âˆƒ A, A =â‚š P) â†’ Î£ A, A =â‚š P. (* è¯æ˜ç•¥ *)
```

è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æå–å‡º Infâ±½ æ‰€æ‰¿è¯ºçš„ $V_{<Ï‰}$ å¹¶å¾—åˆ°è¿›ä¸€æ­¥çš„æ„é€ , å¦‚å®ƒçš„å¹¶ $V_Ï‰$.

```Coq
Hypothesis inf : Infâ±½.

(* V_<Ï‰ é›† *)
Definition VltÏ‰ := proj1_sig (é›†åŒ–å¤§æ¶ˆé™¤ inf).

(* VltÏ‰ =â‚š æœ‰ç©·å±‚ *)
Definition æ— ç©· := proj2_sig (é›†åŒ–å¤§æ¶ˆé™¤ inf).

Definition VÏ‰ := â‹ƒ VltÏ‰.
```

**å¼•ç† 1-4-2** $V_n$ æ˜¯å±‚.  
è¯æ˜: å¯¹nå½’çº³, ç”±å±‚çš„å®šä¹‰å¾—è¯. âˆ

```Coq
Lemma Vnæ˜¯å±‚ n : Vâ‚™ n âˆˆâ‚š å±‚.
Proof. induction n. apply ç©ºé›†å±‚. now constructor. Qed.
```

**å¼•ç† 1-4-3** $V_Ï‰$ æ˜¯å±‚.  
è¯æ˜: ç”±å±‚çš„å®šä¹‰åªéœ€è¯ $V_{<Ï‰}$ âŠ†â‚š å±‚. ç”±æ— ç©·å…¬ç†å¯çŸ¥ $V_{<Ï‰}$ é‡Œéƒ½æ˜¯æŸ $V_n$, è€Œç”±ä¸Šä¸€æ¡å¼•ç†, $V_n$ æ˜¯å±‚. âˆ

```Coq
Lemma VÏ‰æ˜¯å±‚ : VÏ‰ âˆˆâ‚š å±‚.
Proof.
  constructor. intros y Y.
  apply æ— ç©· in Y as [n ->]. apply Vnæ˜¯å±‚.
Qed.
```

**å¼•ç† 1-4-4** $V_n âˆˆ V_{<Ï‰}$.  
è¯æ˜: ç”±æ— ç©·å…¬ç†ç«‹å³å¾—è¯. âˆ

```Coq
Lemma Vnå±VltÏ‰ n : Vâ‚™ n âˆˆ VltÏ‰.
Proof. apply æ— ç©·. now exists n. Qed.
```

**å¼•ç† 1-4-5** $V_n âˆˆ V_Ï‰$.  
è¯æ˜: $V_n âˆˆ V_{n^+} âˆˆ V_{<Ï‰}$, æ‰€ä»¥ $V_n âˆˆ â‹ƒ V_{<Ï‰} = V_Ï‰$. âˆ

```Coq
Lemma Vnå±VÏ‰ n : Vâ‚™ n âˆˆ VÏ‰.
Proof.
  apply å¹¶é›†. exists (Vâ‚™ (S n)).
  split. now apply å¹‚é›†. apply Vnå±VltÏ‰.
Qed.
```

**äº‹å® 1-4-6** $âˆ… âˆˆ V_Ï‰$.  
è¯æ˜: å› ä¸º $V_0 = âˆ…, ä¸” V_0 âˆˆ V_Ï‰$. âˆ

```Coq
Lemma VÏ‰å¯¹ç©ºé›†å°é—­ : âˆ… âˆˆ VÏ‰.
Proof. replace âˆ… with (Vâ‚™ 0) by reflexivity. apply Vnå±VÏ‰. Qed.
```

**å¼•ç† 1-4-7** $x âˆˆ V_Ï‰ â†’ âˆƒ n, x âˆˆ V_n$.  
è¯æ˜: ç”±å¹¶é›†å…¬ç†, å­˜åœ¨ $y$ ä½¿å¾— $x âˆˆ y âˆˆ V_{<Ï‰}$, è€Œ $y$ æ˜¯æŸ $V_n$. âˆ

```Coq
Lemma VÏ‰æˆå‘˜å±æŸVn x : x âˆˆ VÏ‰ â†’ âˆƒ n, x âˆˆ Vâ‚™ n.
Proof.
  intros [y [xy yV]] % å¹¶é›†.
  apply æ— ç©· in yV as [n ->]. now exists n.
Qed.
```

**å¼•ç† 1-4-8** $V_Ï‰ âŠ† â‹ƒ V_Ï‰$.  
è¯æ˜: å¯¹ä»»æ„ $x âˆˆ V_Ï‰$, å­˜åœ¨æŸ $V_n$ ä½¿å¾— $x âˆˆ V_n âˆˆ V_Ï‰$, æ‰€ä»¥ $x âˆˆ â‹ƒ V_Ï‰$. âˆ

```Coq
Lemma VÏ‰ä¹‹å¹¶ : VÏ‰ âŠ† â‹ƒ VÏ‰.
Proof.
  intros x X. apply VÏ‰æˆå‘˜å±æŸVn in X as [n X].
  apply å¹¶é›†. exists (Vâ‚™ n). split; trivial. apply Vnå±VÏ‰.
Qed.
```

**å¼•ç† 1-4-9** $V_Ï‰$ æ˜¯æé™å±‚.  
è¯æ˜: ç”±æé™å±‚çš„å®šä¹‰, å¼•ç† 1-4-3 å’Œå¼•ç† 1-4-8 ç«‹å³å¾—è¯. âˆ

```Coq
Lemma VÏ‰æ˜¯æé™å±‚ : VÏ‰ âˆˆâ‚š æé™å±‚.
Proof. split. apply VÏ‰æ˜¯å±‚. apply VÏ‰ä¹‹å¹¶. Qed.
```

### æ”¯çº¿: $V_Ï‰$ æ˜¯å½’çº³é›†

æˆ‘ä»¬çŸ¥é“åŸç‰ˆçš„æ— ç©·å…¬ç†è¡¨è¿°ä¸ºå­˜åœ¨å½’çº³é›†, è€Œç”± Infâ±½ å¾—åˆ°çš„ $V_Ï‰$ å°±ç»™å‡ºäº†è¿™æ ·ä¸€ä¸ªå½’çº³é›†, æ‰€ä»¥ Infâ±½ è•´å«åŸç‰ˆçš„æ— ç©·å…¬ç† (è®°ä½œ Inf).

```Coq
Definition å½’çº³é›† A := âˆ… âˆˆ A âˆ§ âˆ€ a âˆˆ A, aâº âˆˆ A.

(* æ— ç©·å…¬ç†: å­˜åœ¨å½’çº³é›† *)
Definition Inf := Î£ I, å½’çº³é›† I.
```

**å¼•ç† 1-4-10** x âˆˆ y â†’ y âˆˆâ‚š å±‚ â†’ xâº âˆˆ ğ’« y.  
è¯æ˜: å³è¯å¯¹ä»»æ„ z âˆˆ xâº æœ‰ z âˆˆ y. è‹¥ z = x, æ”¹å†™å‰æå¾—è¯. è‹¥ z âˆˆ x, ç”±å±‚çš„ä¼ é€’æ€§å¾—è¯. âˆ

```Coq
Lemma åç»§_å‡ç§© x y : x âˆˆ y â†’ y âˆˆâ‚š å±‚ â†’ xâº âˆˆ ğ’« y.
Proof.
  intros xy yS. apply å¹‚é›†. intros z zx.
  apply åç»§ in zx as [->|]. trivial. apply å±‚ä¼ é€’ with x; auto.
Qed.
```

**å¼•ç† 1-4-11** $V_Ï‰$ æ˜¯å½’çº³é›†.  
è¯æ˜: 

```Coq
Lemma VÏ‰æ˜¯å½’çº³é›† : å½’çº³é›† VÏ‰.
Proof.
  split. apply VÏ‰å¯¹ç©ºé›†å°é—­.
  intros. apply VÏ‰æˆå‘˜å±æŸVn in H as [n an].
  apply å¹¶é›†. exists (Vâ‚™ (S n)). split.
  - cbn. apply åç»§_å‡ç§©. apply an. apply Vnæ˜¯å±‚.
  - apply Vnå±VltÏ‰.
Qed.
```

### æœ‰ç©·é›†

